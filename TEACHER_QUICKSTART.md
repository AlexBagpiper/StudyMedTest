# Быстрый старт: Создание учетных записей преподавателей

## Краткое описание

Был добавлен полноценный функционал создания и управления учетными записями преподавателей. Только администраторы могут создавать, редактировать и удалять учетные записи преподавателей.

## Что было добавлено

### Backend

1. **Admin API endpoints** (уже были, но теперь активно используются):
   - `POST /api/v1/admin/users` - создание пользователя
   - `GET /api/v1/admin/users` - список пользователей с фильтрацией
   - `GET /api/v1/admin/users/{user_id}` - получение пользователя
   - `PUT /api/v1/admin/users/{user_id}` - обновление пользователя
   - `DELETE /api/v1/admin/users/{user_id}` - удаление пользователя
   - `GET /api/v1/admin/stats` - статистика

2. **Скрипт создания преподавателя через консоль**: `backend/create_teacher.py`

3. **Тесты**: `backend/tests/test_admin_users.py` - полное покрытие функционала

### Frontend

1. **Новый компонент**: `frontend/src/pages/admin/UsersManagement.tsx`
   - Список пользователей с фильтрацией и поиском
   - Модальное окно создания/редактирования пользователя
   - Управление статусом и ролями

2. **Обновленная страница администратора**: `frontend/src/pages/admin/AdminPage.tsx`
   - Навигация по разделам
   - Хлебные крошки

3. **API функции**: `frontend/src/lib/api.ts` - полный набор admin API

### Документация

- `docs/TEACHER_MANAGEMENT.md` - подробная документация по управлению преподавателями

## Быстрое использование

### Вариант 1: Через веб-интерфейс (рекомендуется)

1. Запустите приложение:
   ```bash
   # Windows
   start-all.bat
   
   # Linux/Mac
   ./start-all.sh
   ```

2. Войдите как администратор (если еще не создан, используйте скрипт `create_admin.py`)

3. Перейдите в раздел "Администрирование"

4. Нажмите на карточку "Пользователи"

5. Нажмите кнопку "Создать преподавателя"

6. Заполните форму:
   - Email
   - Пароль (минимум 6 символов)
   - Фамилия, Имя, Отчество
   - Роль: выберите "Преподаватель"
   - Статус: "Активен"
   - Подтверждён: "Да"

7. Нажмите "Создать"

### Вариант 2: Через консоль

```bash
cd backend
python create_teacher.py
```

Следуйте инструкциям на экране.

### Вариант 3: Через API

```bash
# Сначала получите токен администратора
curl -X POST "http://localhost:8000/api/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@example.com","password":"adminpassword"}'

# Создайте преподавателя
curl -X POST "http://localhost:8000/api/v1/admin/users" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "teacher@example.com",
    "password": "securepassword",
    "last_name": "Иванов",
    "first_name": "Иван",
    "middle_name": "Иванович",
    "role": "teacher",
    "is_active": true,
    "is_verified": true
  }'
```

## Функции веб-интерфейса

### Поиск и фильтрация

- **Поиск**: Введите текст в строку поиска для поиска по email, фамилии или имени
- **Вкладки**: Фильтруйте по ролям (Все, Администраторы, Преподаватели, Студенты)

### Управление пользователями

- **Редактирование**: Нажмите иконку карандаша рядом с пользователем
- **Удаление**: Нажмите иконку корзины (требует подтверждения)
- **Статус**: Изменяйте статус "Активен/Неактивен" для временной блокировки

### Отображаемая информация

Для каждого пользователя показывается:
- ФИО
- Email
- Роль (цветной бейдж)
- Статус (Активен/Неактивен)
- Дата создания

## Права преподавателей

После создания учетной записи преподаватель может:

- ✅ Создавать вопросы
- ✅ Редактировать свои вопросы
- ✅ Создавать тесты
- ✅ Редактировать свои тесты
- ✅ Публиковать тесты для студентов
- ✅ Просматривать результаты студентов
- ✅ Просматривать список студентов
- ✅ Просматривать аналитику по своим тестам

Преподаватель НЕ может:
- ❌ Создавать других пользователей
- ❌ Редактировать чужие вопросы/тесты
- ❌ Удалять пользователей
- ❌ Получать доступ к admin панели

## Безопасность

- Все пароли хешируются с использованием bcrypt
- Все админские действия логируются в audit log
- Только администраторы имеют доступ к `/api/v1/admin/*` endpoints
- JWT токены используются для аутентификации

## Тестирование

Запустите тесты:

```bash
cd backend
pytest tests/test_admin_users.py -v
```

Тесты покрывают:
- Создание преподавателя администратором
- Проверку на дублирование email
- Запрет создания не-администратором
- Получение списка пользователей
- Фильтрацию по роли
- Поиск пользователей
- Обновление данных
- Удаление пользователей
- Получение статистики
- Защиту от самоудаления администратора

## Troubleshooting

### Ошибка "Admin access required"
**Решение**: Убедитесь что вы вошли как администратор. Проверьте роль пользователя в БД.

### Ошибка "Email already registered"
**Решение**: Email уже занят. Используйте другой email или найдите существующего пользователя.

### Не отображается кнопка "Создать преподавателя"
**Решение**: Убедитесь что вы вошли как администратор. Только администраторы видят эту кнопку.

### Ошибка при загрузке списка пользователей
**Решение**: 
1. Проверьте что backend запущен
2. Проверьте консоль браузера на наличие ошибок
3. Проверьте что токен валиден

## Дополнительная информация

Подробная документация: [docs/TEACHER_MANAGEMENT.md](docs/TEACHER_MANAGEMENT.md)

API документация: http://localhost:8000/docs (после запуска backend)
